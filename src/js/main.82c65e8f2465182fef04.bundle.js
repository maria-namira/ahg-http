"use strict";(self.webpackChunkahj_7_3_http_frontend=self.webpackChunkahj_7_3_http_frontend||[]).push([[179],{802:()=>{class e{constructor(e){this.baseURL=e}saveImage(e,t){this.file=e;const s=new FormData;s.append("image",this.file);const r={method:"POST",query:"method=saveImage",body:s};return this.creatRequest(r,t)}allImages(e){return this.creatRequest({method:"GET",query:"method=allImages",body:null},e)}removeImage(e,t){const s=new FormData;s.append("id",e);const r={method:"POST",query:"method=removeImage",body:s};return this.creatRequest(r,t)}creatRequest(e,t){const s=new XMLHttpRequest,r=`${this.baseURL}?${e.query}`;s.open(e.method,r),s.addEventListener("load",(()=>{if(s.status>=200&&s.status<300)try{const e=JSON.parse(s.responseText);t(e)}catch(e){console.error(e)}})),s.send(e.body)}}(new class{constructor(){this.input=document.querySelector(".input"),this.label=document.querySelector(".label"),this.gallery=document.querySelector(".gallery__row.row"),this.api=new e("https://ahj-7-3-sergius-image-manager.herokuapp.com/"),this.currentID=null,this.onChange=this.onChange.bind(this),this.onDrop=this.onDrop.bind(this),this.creatPreview=this.creatPreview.bind(this),this.redrawImages=this.redrawImages.bind(this),this.onClick=this.onClick.bind(this),this.removePreview=this.removePreview.bind(this)}init(){this.input.addEventListener("change",this.onChange),this.label.addEventListener("dragover",(e=>e.preventDefault())),this.label.addEventListener("drop",this.onDrop),this.gallery.addEventListener("click",this.onClick),this.api.allImages(this.redrawImages)}onDrop(e){e.preventDefault();const t=Array.from(e.dataTransfer.files)[0];this.api.saveImage(t,this.creatPreview)}onChange(e){e.preventDefault();const t=Array.from(e.currentTarget.files)[0];this.api.saveImage(t,this.creatPreview),this.input.value=""}onClick(e){"row-item__delete"===e.target.className&&(this.currentID=e.target.nextElementSibling.dataset.id,this.api.removeImage(this.currentID,this.removePreview)),"row-item__img"===e.target.className&&e.target.closest(".absolute").classList.toggle("zoom")}redrawImages(e){e.forEach((e=>this.creatPreview(e)))}creatPreview(e){const t=e.fileName.slice(0,e.fileName.lastIndexOf("."));this.gallery.insertAdjacentHTML("beforeend",`<div class="row__item">\n         <div class="absolute">\n           <button class="row-item__delete">&#10006;</button>\n           <img src="${this.api.baseURL}${e.fileName}" data-id="${t}" class="row-item__img">\n         </div>\n       </div>`)}removePreview(e){e.success&&this.currentID&&(document.querySelector(`[data-id="${this.currentID}"]`).closest(".row__item").remove(),this.currentID=null)}}).init()}},e=>{var t;t=802,e(e.s=t)}]);
